---
title: "Life-Expectancy-Analysis"
author: "Milena Biernacka, Agata Dratwa"
date: '2023-05-19'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(corrplot)
```

Reading data:
```{r}
data <- read.csv("Life-Expectancy-Data.csv")
head(data)
dim(data)
str(data)
```

Dropping columns containing NA values:
```{r}
data <- na.omit(data)
dim(data)
```

Dropping columns 'Country' and 'Year':
```{r}
data <- data[, -c(1,2)]
head(data)
```
Correlation between numerical attributes:
```{r}
cor(data[,-1])
```
```{r}
corrplot(cor(data[,-1]), method = 'color')
```


### Building linear regression model:


```{r}
model <- lm(data$Life.expectancy ~ ., data = data)
```
```{r}
model
model$coefficients
```
```{r}
summary(model)
```

Based on p-value statistically significant are:

- Status
- Adult Mortality
- Indant deaths
- Alcohol
- Percentage expenditure
- BMI
- Under five deaths
- Total.expenditure 
- Diphtheria
- HIV AIDS
- Income
- Schooling

It means that we should remove other variables from our model.

Positive coefficients:

- Indant deaths
- Percentage expenditure
- Income
- Schooling
- Diphtheria
- Total.expenditure 
- BMI

Negative coefficients:

- Status
- Adult Mortality
- HIV AIDS
- Alcohol
- Under five deaths

